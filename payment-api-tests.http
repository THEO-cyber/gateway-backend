### HND Gateway Payment System API Tests
### Make sure your server is running on localhost:5000

@baseUrl = http://localhost:5000/api
@authToken = YOUR_AUTH_TOKEN_HERE

### 1. Get Payment Fee (Public)
GET {{baseUrl}}/payment/fee
Content-Type: application/json

### 2. Login to get auth token (Update credentials as needed)
POST {{baseUrl}}/auth/login
Content-Type: application/json

{
  "email": "test@example.com",
  "password": "testpassword123"
}

### 3. Initiate Payment (Authenticated)
POST {{baseUrl}}/payment/initiate
Authorization: Bearer {{authToken}}
Content-Type: application/json

{
  "phone": "671234567",
  "purpose": "registration_fee",
  "description": "Test payment for HND Gateway"
}

### 4. Check Payment Status (Replace with actual transaction ID)
GET {{baseUrl}}/payment/status/HND_1708000000000_ABC123
Authorization: Bearer {{authToken}}

### 5. Get Payment History
GET {{baseUrl}}/payment/history?page=1&limit=5
Authorization: Bearer {{authToken}}

### 6. Test Webhook (Simulate Nkwa Pay webhook)
POST {{baseUrl}}/payment/webhook
Content-Type: application/json
X-Signature: test-signature

{
  "reference": "HND_1708000000000_TEST123",
  "status": "successful",
  "transactionId": "NKWA_123456789",
  "amount": 1000,
  "phoneNumber": "237671234567",
  "message": "Payment completed successfully"
}

### 7. Admin: Get All Payments (Requires admin privileges)
GET {{baseUrl}}/payment/admin/all?page=1&limit=10&status=success
Authorization: Bearer {{authToken}}

### 8. Admin: Get Payment Statistics (Requires admin privileges)
GET {{baseUrl}}/payment/admin/stats
Authorization: Bearer {{authToken}}

### 9. Admin: Retry Payment Webhook (Replace with actual transaction ID)
POST {{baseUrl}}/payment/admin/retry/HND_1708000000000_ABC123
Authorization: Bearer {{authToken}}

### 10. Test different payment purposes
POST {{baseUrl}}/payment/initiate
Authorization: Bearer {{authToken}}
Content-Type: application/json

{
  "phone": "677889900",
  "purpose": "test_fee",
  "description": "Test fee payment"
}

### 11. Test invalid phone number (should fail)
POST {{baseUrl}}/payment/initiate
Authorization: Bearer {{authToken}}
Content-Type: application/json

{
  "phone": "123",
  "purpose": "registration_fee"
}

### 12. Test missing phone number (should fail)
POST {{baseUrl}}/payment/initiate
Authorization: Bearer {{authToken}}
Content-Type: application/json

{
  "purpose": "registration_fee"
}

### 13. Test webhook with different status
POST {{baseUrl}}/payment/webhook
Content-Type: application/json

{
  "reference": "HND_1708000000000_FAIL123",
  "status": "failed",
  "transactionId": "NKWA_987654321",
  "amount": 1000,
  "phoneNumber": "237671234567",
  "message": "Payment was cancelled by user"
}

### 14. Get payment history with filtering
GET {{baseUrl}}/payment/history?page=1&limit=10&status=success
Authorization: Bearer {{authToken}}

### 15. Admin: Get payments with phone filter
GET {{baseUrl}}/payment/admin/all?phone=67123&page=1&limit=5
Authorization: Bearer {{authToken}}